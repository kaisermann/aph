!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("aph",n):t.aph=n()}(this,function(){"use strict";function t(t,n){return E.prototype.set.call(this,t,n),this.aph.owner}function n(n,r){for(var i=[],f=0,u=n.length,c=void 0;f<u;f++)if(null!=(c=n[f]))if(1===c.nodeType)~i.indexOf(c)||i.push(c);else{if(!((c instanceof NodeList||c.constructor instanceof Array)&&1===c[0].nodeType||c.constructor===E||c instanceof HTMLCollection))return m.forEach(function(t){n[t]=E.prototype[t]}),n.set=t,n.aph={owner:r},new Proxy(n,{set:function(t,n,e){t.set(n,e)},get:function(t,n){if(e(t,n))return t[n];if(o(t[0][n]))return s(n,t[0]).bind(t);if(e(t[0],n))return t.map(function(t){return t[n]})}});for(var h=0,p=c.length;h<p;h++)~i.indexOf(c[h])||i.push(c[h])}return new E(i,r?r.aph.context:null,{owner:r})}function e(t,n){return void 0!==t[n]}function r(t){return"string"==typeof t}function o(t){return"function"==typeof t}function i(t){return t&&!r(t)&&!o(t)&&e(t,"length")}function f(t,n){var e,r;if(e=g.exec(t)){if(r=e[3])return n.getElementsByClassName(r);if(r=e[2])return n.getElementsByTagName(r);if(r=e[1])return y.getElementById(r)}return n.querySelectorAll(t)}function u(t){return t?t instanceof Node?t:r(t)?f(t,y)[0]:i(t)?t[0]:y:y}function c(t,n){if(n=v.exec(t))return y.createElement(n[1]);if(!l){var e=(l=y.implementation.createHTMLDocument()).createElement("base");e.href=document.location.href,l.head.appendChild(e)}return l.body.innerHTML=t,l.body.childNodes[0]}function h(t,n,e){var r=t.map(function(t){return t[n].apply(t,e)});return null!=r[0]||null!=r[r.length-1]?r:p(t)}function p(t){for(;t.constructor!==E;)t=t.aph.owner;return t}function s(t,n){var r=n.constructor.name;if(e(w,r)||(w[r]={}),!e(w[r],t)){var o="set"===t.substr(0,3)&&"s"!==t[t.length-1];w[r][t]=o?function(){var n=arguments;return 1===n.length&&n[0].constructor===Object?p(this.forEach(function(e){for(var r in n[0])e[t](r,n[0][r])})):h(this,t,n)}:function(){return h(this,t,arguments)}}return w[r][t]}function a(t,n,e){return new E(t,n,e)}var l,d=Array.prototype,y=document,m=["map","filter","forEach","get"],g=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,v=/(\w+)\/?>(?:<\/\1)?/i,w={},E=function(t,n,e){if(this.aph=e||{},r(t)&&(t="<"===t[0]&&">"===t[t.length-1]&&t.length>2?c(t):f(t,this.aph.context=u(n))),!t)return this;if(1===t.nodeType||t===window)this[0]=t,this.length=1;else for(var o=this.length=t.length;o--;this[o]=t[o]);};E.prototype.forEach=function(t){for(var n=0,e=this.length;n<e&&!1!==t.call(this,this[n],n++););return this},E.prototype.map=function(t){for(var e=[],r=this.length;r--;e[r]=t(this[r],r,this));return n(e,this)},E.prototype.filter=function(t){return n(d.filter.call(this,t),this)},E.prototype.find=function(t){return new E(t,this[0],{owner:this})},E.prototype.asArray=function(){return d.slice.call(this)},E.prototype.get=function(t){return this.map(function(n){return n[t]})},E.prototype.set=function(t,n){return this.forEach("object"!=typeof t?function(e){e[t]=n}:function(n){for(var e in t)n[e]=t[e]})},E.prototype.css=function(t,n){return"object"!=typeof t?null==n?this.map(function(n){return getComputedStyle(n)[t]}):this.forEach(function(e){e.style[t]=n}):this.forEach(function(n){for(var e in t)n.style[e]=t[e]})},E.prototype.detach=function(){return this.forEach(function(t){t.parentNode.removeChild(t)})},E.prototype.append=function(t){return this.html(t,function(t,n){t.appendChild(n)})},E.prototype.appendTo=function(t){return new E(t).append(this),this},E.prototype.prepend=function(t){return this.html(t,function(t,n){t.insertBefore(n,t.firstChild)})},E.prototype.prependTo=function(t){return new E(t).prepend(this),this},E.prototype.html=function(t,n){if(null==t)return this.map(function(t){return t.innerHTML});if(!(n instanceof Function))return this.forEach(function(t){t.innerHTML=""}).append(t);i(t)||(t=[t]);for(var e=[],o=0,f=t.length;o<f;o++)if(i(t[o]))for(var u=0,h=t[o].length;u<h;u++)~e.indexOf(t[o][u])||e.push(t[o][u]);else e.push(t[o]);return this.forEach(function(t){return e.forEach(function(e){n(t,r(e)?c(e):e)})})},a.fn=E.prototype,a.wrap=n,a.querySelector=function(t,n){f(t,u(n))};var b=["concat","copyWithin","fill","join","reduce","reduceRight","splice","sort","slice"];Object.getOwnPropertyNames(d).forEach(function(t){~b.indexOf(t)||e(a.fn,t)||(a.fn[t]=d[t])});var x=c("<div>");for(var T in x)!function(t){e(a.fn,t)||(o(x[t])?a.fn[t]=s(t,x):Object.defineProperty(a.fn,t,{get:function(){return this.get(t)},set:function(n){this.set(t,n)}}))}(T);return x=null,a});