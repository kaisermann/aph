!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("aph",n):t.aph=n()}(this,function(){"use strict";function t(){return O.prototype.set.apply(this,arguments),this.aph.owner}function n(n,e){for(var r=[],o=0,i=n.length,f=void 0;o<i;o++)if(null!=(f=n[o]))if(1===f.nodeType)~r.indexOf(f)||r.push(f);else{if(!((f instanceof NodeList||f instanceof Array)&&1===f[0].nodeType||f instanceof O||f instanceof HTMLCollection))return["map","filter","forEach","get","call"].forEach(function(t){n[t]=O.prototype[t]}),n.set=t,n.aph={owner:e},a(n,f,function(t){return t.aph.owner}),n;for(var u=0,c=f.length;u<c;u++)~r.indexOf(f[u])||r.push(f[u])}return new O(r,e.aph.context,{owner:e})}function e(t,n){return void 0!==t[n]}function r(t,n){for(var e=t.length;e--;)n(t[e],e)}function o(t){return"string"==typeof t}function i(t){return t&&!o(t)&&"function"!=typeof t&&null!=t.length}function f(t){return null!=t[0]||null!=t[t.length-1]}function u(t,n){var e,r;if(e=g.exec(t)){if(r=e[3])return n.getElementsByClassName(r);if(r=e[2])return n.getElementsByTagName(r);if(r=e[1])return m.getElementById(r)}return n.querySelectorAll(t)}function c(t){return t?t instanceof Node?t:o(t)?u(t,m)[0]:i(t)?t[0]:m:m}function p(t,n){if(n=v.exec(t))return m.createElement(n[1]);if(!y){var e=(y=m.implementation.createHTMLDocument()).createElement("base");e.href=document.location.href,y.head.appendChild(e)}return y.body.innerHTML=t,y.body.childNodes[0]}function h(t,n,r,o,i){if(!e(t,r))try{n[r]instanceof Function?(w[o][r]||(w[o][r]="set"===r.substr(0,3)&&"s"!==r[r.length-1]?function(){var t=arguments;if(1===t.length&&t[0].constructor===Object)return i(this.forEach(function(e){for(var o in t[0])n[r].call(e,o,t[0][o])}));var e=this.map(function(e){return n[r].apply(e,t)});return f(e)?e:i(this)}:function(){var t=arguments,e=this.map(function(e){return n[r].apply(e,t)});return f(e)?e:i(this)}),t[r]=w[o][r]):s(t,r)}catch(n){s(t,r)}}function a(t,n,o){var i=n.constructor.name,f=Object.getPrototypeOf(n);if(w[i])r(E[i],function(n){h(t,f,n,i,o)}),r(b[i],function(n){h(t,f,n,i,o)});else{var u={};E[i]=Object.getOwnPropertyNames(f),w[i]={},b[i]=[],r(E[i],function(n){h(t,f,n,i,o),u[n]=1});for(var c in n)isNaN(c)&&!e(u,c)&&(b[i].push(c),h(t,f,c,i,o))}}function s(t,n){Object.defineProperty(t,n,{get:function(){return this.get(n)},set:function(t){this.set(n,t)}})}function l(t,n,e){return new O(t,n,e)}var y,d=Array.prototype,m=document,g=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,v=/(\w+)\/?>(?:<\/\1)?/i,w={},E={},b={},O=function(t,n,e){if(this.aph=e||{},o(t)&&(t="<"===t[0]&&">"===t[t.length-1]&&t.length>2?p(t):u(t,this.aph.context=c(n))),!t)return this;if(1===t.nodeType||t===window)this[0]=t,this.length=1;else for(var r=this.length=t.length;r--;this[r]=t[r]);};O.prototype.call=function(t){var n=arguments,e=this.map(function(e,r){return e[t].apply(e,n)});return f(e)?e:this},O.prototype.map=function(){return n(d.map.apply(this,arguments),this)},O.prototype.filter=function(){return n(d.filter.apply(this,arguments),this)},O.prototype.forEach=function(t){for(var n=0,e=this.length;n<e&&!1!==t.call(this,this[n],n++););return this},O.prototype.find=function(t){return new O(t,this[0],{owner:this})},O.prototype.asArray=function(){return d.slice.call(this)},O.prototype.get=function(t){return this.map(function(n){return n[t]})},O.prototype.set=function(t,n){return"object"!=typeof t?this.forEach(function(e){e[t]=n}):this.forEach(function(n){for(var e in t)n[e]=t[e]})},O.prototype.css=function(t,n){return"object"!=typeof t?null==n?this.map(function(n){return getComputedStyle(n)[t]}):this.forEach(function(e){e.style[t]=n}):this.forEach(function(n){for(var e in t)n.style[e]=t[e]})},O.prototype.detach=function(){return this.forEach(function(t){t.parentNode.removeChild(t)})},O.prototype.append=function(t){return this.html(t,function(t,n){t.appendChild(n)})},O.prototype.appendTo=function(t){return new O(t).append(this),this},O.prototype.prepend=function(t){return this.html(t,function(t,n){t.insertBefore(n,t.firstChild)})},O.prototype.prependTo=function(t){return new O(t).prepend(this),this},O.prototype.html=function(t,n){if(null==t)return this.map(function(t){return t.innerHTML});if(!(n instanceof Function))return this.forEach(function(t){t.innerHTML=""}).append(t);i(t)||(t=[t]);for(var e=[],r=0,f=t.length;r<f;r++)if(i(t[r]))for(var u=0,c=t[r].length;u<c;u++)~e.indexOf(t[r][u])||e.push(t[r][u]);else e.push(t[r]);return this.forEach(function(t){return e.forEach(function(e){n(t,o(e)?p(e):e)})})},l.fn=O.prototype,l.wrap=n,l.querySelector=function(t,n){u(t,c(n))};var T=["concat","copyWithin","fill","join","reduce","reduceRight","slice","splice","sort"];return Object.getOwnPropertyNames(d).forEach(function(t){~T.indexOf(t)||null!=l.fn[t]||(l.fn[t]=d[t])}),a(l.fn,p("<div>"),function(t){return t}),l});