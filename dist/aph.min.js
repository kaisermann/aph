!function(n,e){typeof exports==='object'&&typeof module!=='undefined'?module.exports=e():typeof define==='function'&&define.amd?define('$$',e):(n.$$=e())}(this,(function(){"use strict";let n=Array.prototype,e=document;function t(n,e){return typeof n[e]!=='undefined'}function r(n){return typeof n==='string'}function u(n){return typeof n==='function'}function o(n){return typeof n==='number'&&Math.floor(n)===n}function c(n){return n&&!r(n)&&!u(n)&&t(n,'length')}let l=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/;function f(n,t){let r,u;if(r=l.exec(n)){if(u=r[3]){return t.getElementsByClassName(u)}if(u=r[2]){return t.getElementsByTagName(u)}if(u=r[1]){return e.getElementById(u)}}return t.querySelectorAll(n)}function i(n){return!n?e:n instanceof Node?n:r(n)?f(n,e)[0]:c(n)?n[0]:e}let a=/^<(\w+)\/?>(?:$|<\/\1>)/i,p;function h(n,t){if(!/\r|\n/.test(n)&&(t=a.exec(n))){return e.createElement(t[1])}if(!p){p=e.implementation.createHTMLDocument();let n=p.createElement('base');n.href=document.location.href;p.head.appendChild(n)}p.body.innerHTML=n;return p.body.childNodes[0]}let s={};function d(n){while(n.aph===void 0)n=n.owner;return m(n)}function g(n,e,t){let r=n.map(n=>n[e].apply(n,t));return r[0]!=null&&r[r.length-1]!=null?r:d(n)}function m(n){return new Proxy(n,{set(n,e,t){n.set(e,t)},get(n,e){if(t(n,e)){return n[e]}if(n.length){if(u(n[0][e])){return y(e,n[0]).bind(n)}if(t(n[0],e)){return n.map(n=>n[e])}}return void 0}})}function y(n,e){let r=e.constructor.name;t(s,r)||(s[r]={});t(s[r],n)||(s[r][n]=n.substr(0,3)==='set'&&n[n.length-1]!=='s'?function(){let e=arguments;if(e.length===1&&e[0].constructor===Object){return d(this.forEach(t=>{for(let r in e[0])t[n](r,e[0][r])}))}return g(this,n,e)}:function(){return g(this,n,arguments)});return s[r][n]}let E={};class w{constructor(n,e,t = {}){this.aph=t;this.aph.context=e=i(e);this.length=0;r(n)&&(n=n[0]==='<'&&n[n.length-1]==='>'?h(n):f(n,e));if(!n)return this;if(n.nodeType===1||n.nodeType===9||n===window)this[0]=n,this.length=1;else{for(let e=this.length=n.length;e--;this[e]=n[e]);}return m(this)}forEach(n){for(let e=0,t=this.length;e<t&&n.call(this,this[e],e++)!==!1;);;return this}map(n){let e=[];for(let t=this.length;t--;e[t]=n(this[t],t,this));;return w.wrap(e,this)}filter(e){return w.wrap(n.filter.call(this,e),this)}find(n){return new w(n,this[0],{owner:this})}asArray(){return n.slice.call(this)}get(n){return this.map(e=>e[n])}set(n,e){return d(this.forEach(r(n)||o(n)?t=>{t[n]=e}:e=>{for(let t in n)e[t]=n[t]}))}css(n,e){if(r(n)&&e==null){return this.map(e=>getComputedStyle(e)[n])}return this.style.set(n,e)}detach(){return this.forEach(n=>n.parentNode.removeChild(n))}append(n){return this.html(n,(n,e)=>n.appendChild(e))}appendTo(n){new w(n).append(this);return this}prepend(n){return this.html(n,(n,e)=>{n.insertBefore(e,n.firstChild)})}prependTo(n){new w(n).prepend(this);return this}html(n,e){if(n==null){return this.map(n=>n.innerHTML)}if(!u(e)){return this.forEach(n=>{n.innerHTML=''}).append(n)}c(n)||(n=[n]);let t=[];for(let e=0,r=n.length;e<r;e++){if(c(n[e])){for(let r=0,u=n[e].length;r<u;r++)t.indexOf(n[e][r])<0&&t.push(n[e][r])}else t.push(n[e])}return this.forEach(n=>{t.forEach(t=>{e(n,r(t)?h(t):t)})})}static querySelector(n,e){return f(n,i(e))}static wrap(n,e){let t=[];for(let r=0,u=n.length,o;r<u;r++){o=n[r];if(o==null)continue;if(o.nodeType===1)t.indexOf(o)<0&&t.push(o);else if((o instanceof NodeList||Array.isArray(o))&&o[0].nodeType===1||o.aph!==void 0||o instanceof HTMLCollection){for(let n=0,e=o.length;n<e;n++)t.indexOf(o[n])<0&&t.push(o[n])}else{return m(Object.assign(n,E,{owner:e}))}}return new w(t,e.aph?e.aph.context:null,{owner:e})}}['map','filter','forEach','get','set'].forEach(n=>{E[n]=w.prototype[n]});function T(n,e,t){return new w(n,e,t)}T.fn=w.prototype;return T}))