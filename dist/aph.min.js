!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("$$",n):t.$$=n()}(this,function(){"use strict";function t(t,n){return d.prototype.set.call(this,t,n),this.aph.owner}function n(t,n){return void 0!==t[n]}function e(t){return"string"==typeof t}function r(t){return"function"==typeof t}function o(t){return"number"==typeof t&&Math.floor(t)===t}function i(t){return t&&!e(t)&&!r(t)&&n(t,"length")}function u(t,n){var e,r;if(e=m.exec(t)){if(r=e[3])return n.getElementsByClassName(r);if(r=e[2])return n.getElementsByTagName(r);if(r=e[1])return l.getElementById(r)}return n.querySelectorAll(t)}function f(t){return t?t instanceof Node?t:e(t)?u(t,l)[0]:i(t)?t[0]:l:l}function c(t,n){if(n=g.exec(t))return l.createElement(n[1]);if(!y){var e=(y=l.implementation.createHTMLDocument()).createElement("base");e.href=document.location.href,y.head.appendChild(e)}return y.body.innerHTML=t,y.body.childNodes[0]}function p(t){for(;t.constructor!==d;)t=t.aph.owner;return t}function h(t,n,e){var r=t.map(function(t){return t[n].apply(t,e)});return null!=r[0]&&null!=r[r.length-1]?r:p(t)}function s(t,e){var r=e.constructor.name;return n(v,r)||(v[r]={}),n(v[r],t)||(v[r][t]="set"===t.substr(0,3)&&"s"!==t[t.length-1]?function(){var n=arguments;return 1===n.length&&n[0].constructor===Object?p(this.forEach(function(e){for(var r in n[0])e[t](r,n[0][r])})):h(this,t,n)}:function(){return h(this,t,arguments)}),v[r][t]}var a=Array.prototype,l=document,d=function t(n,r,o){if(!this)return new t(n,r,o);if(this.aph=o||{},this.aph.context=r=f(r),this.length=0,e(n)&&(n="<"===n[0]&&">"===n[n.length-1]?c(n):u(n,r)),!n)return this;if(1===n.nodeType||n===window)this[0]=n,this.length=1;else for(var i=this.length=n.length;i--;this[i]=n[i]);};d.prototype.forEach=function(t){for(var n=0,e=this.length;n<e&&!1!==t.call(this,this[n],n++););return this},d.prototype.map=function(t){for(var n=[],e=this.length;e--;n[e]=t(this[e],e,this));return d.wrap(n,this)},d.prototype.filter=function(t){return d.wrap(a.filter.call(this,t),this)},d.prototype.find=function(t){return d(t,this[0],{owner:this})},d.prototype.asArray=function(){return a.slice.call(this)},d.prototype.get=function(t){return this.map(function(n){return n[t]})},d.prototype.set=function(t,n){return this.forEach(e(t)||o(t)?function(e){e[t]=n}:function(n){for(var e in t)n[e]=t[e]})},d.prototype.css=function(t,n){return e(t)&&null==n?this.map(function(n){return getComputedStyle(n)[t]}):this.style.set(t,n)},d.prototype.detach=function(){return this.forEach(function(t){t.parentNode.removeChild(t)})},d.prototype.append=function(t){return this.html(t,function(t,n){t.appendChild(n)})},d.prototype.appendTo=function(t){return d(t).append(this),this},d.prototype.prepend=function(t){return this.html(t,function(t,n){t.insertBefore(n,t.firstChild)})},d.prototype.prependTo=function(t){return d(t).prepend(this),this},d.prototype.html=function(t,n){if(null==t)return this.map(function(t){return t.innerHTML});if(!r(n))return this.forEach(function(t){t.innerHTML=""}).append(t);i(t)||(t=[t]);for(var o=[],u=0,f=t.length;u<f;u++)if(i(t[u]))for(var p=0,h=t[u].length;p<h;p++)o.indexOf(t[u][p])<0&&o.push(t[u][p]);else o.push(t[u]);return this.forEach(function(t){return o.forEach(function(r){n(t,e(r)?c(r):r)})})},d.querySelector=function(t,n){return u(t,f(n))},d.wrap=function(e,o){for(var i=[],u=0,f=e.length,c=void 0;u<f;u++)if(null!=(c=e[u]))if(1===c.nodeType)i.indexOf(c)<0&&i.push(c);else{if(!((c instanceof NodeList||c.constructor instanceof Array)&&1===c[0].nodeType||c.constructor===d||c instanceof HTMLCollection))return e.map=d.prototype.map,e.filter=d.prototype.filter,e.forEach=d.prototype.forEach,e.get=d.prototype.get,e.set=t,e.aph={owner:o},new Proxy(e,{set:function(t,n,e){t.set(n,e)},get:function(t,e){return n(t,e)?t[e]:r(t[0][e])?s(e,t[0]).bind(t):n(t[0],e)?t.map(function(t){return t[e]}):void 0}});for(var p=0,h=c.length;p<h;p++)i.indexOf(c[p])<0&&i.push(c[p])}return d(i,o?o.aph.context:null,{owner:o})},d.fn=d.prototype;var y,m=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,g=/<(\w+)\/?>(?:<\/\1>)?/i,v={},w=c("<div>");for(var E in w)n(d.fn,E)||function(t){r(w[t])?d.fn[t]=s(t,w):Object.defineProperty(d.fn,t,{get:function(){return this.get(t)},set:function(n){this.set(t,n)}})}(E);return w=null,d});