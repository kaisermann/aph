!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define("$$",n):t.$$=n()}(this,function(){"use strict";function t(t,n){return E.prototype.set.call(this,t,n),this.aph.owner}function n(n,r){for(var i=[],u=0,f=n.length,c=void 0;u<f;u++)if(null!=(c=n[u]))if(1===c.nodeType)i.indexOf(c)<0&&i.push(c);else{if(!((c instanceof NodeList||c.constructor instanceof Array)&&1===c[0].nodeType||c.constructor===E||c instanceof HTMLCollection))return n.map=E.prototype.map,n.filter=E.prototype.filter,n.forEach=E.prototype.forEach,n.get=E.prototype.get,n.set=t,n.aph={owner:r},new Proxy(n,{set:function(t,n,e){t.set(n,e)},get:function(t,n){return e(t,n)?t[n]:o(t[0][n])?a(n,t[0]).bind(t):e(t[0],n)?t.map(function(t){return t[n]}):void 0}});for(var p=0,h=c.length;p<h;p++)i.indexOf(c[p])<0&&i.push(c[p])}return new E(i,r?r.aph.context:null,{owner:r})}function e(t,n){return void 0!==t[n]}function r(t){return"string"==typeof t}function o(t){return"function"==typeof t}function i(t){return"number"==typeof t&&Math.floor(t)===t}function u(t){return t&&!r(t)&&!o(t)&&e(t,"length")}function f(t,n){var e,r;if(e=g.exec(t)){if(r=e[3])return n.getElementsByClassName(r);if(r=e[2])return n.getElementsByTagName(r);if(r=e[1])return m.getElementById(r)}return n.querySelectorAll(t)}function c(t){return t?t instanceof Node?t:r(t)?f(t,m)[0]:u(t)?t[0]:m:m}function p(t,n){if(n=v.exec(t))return m.createElement(n[1]);if(!d){var e=(d=m.implementation.createHTMLDocument()).createElement("base");e.href=document.location.href,d.head.appendChild(e)}return d.body.innerHTML=t,d.body.childNodes[0]}function h(t){for(;t.constructor!==E;)t=t.aph.owner;return t}function s(t,n,e){var r=t.map(function(t){return t[n].apply(t,e)});return null!=r[0]&&null!=r[r.length-1]?r:h(t)}function a(t,n){var r=n.constructor.name;return e(w,r)||(w[r]={}),e(w[r],t)||(w[r][t]="set"===t.substr(0,3)&&"s"!==t[t.length-1]?function(){var n=arguments;return 1===n.length&&n[0].constructor===Object?h(this.forEach(function(e){for(var r in n[0])e[t](r,n[0][r])})):s(this,t,n)}:function(){return s(this,t,arguments)}),w[r][t]}function l(t,n,e){return new E(t,n,e)}var d,y=Array.prototype,m=document,g=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,v=/<(\w+)\/?>(?:<\/\1>)?/i,w={},E=function(t,n,e){if(this.aph=e||{},r(t)&&(t="<"===t[0]&&">"===t[t.length-1]&&t.length>2?p(t):f(t,this.aph.context=c(n))),!t)return this;if(1===t.nodeType||t===window)this[0]=t,this.length=1;else for(var o=this.length=t.length;o--;this[o]=t[o]);};E.prototype.forEach=function(t){for(var n=0,e=this.length;n<e&&!1!==t.call(this,this[n],n++););return this},E.prototype.map=function(t){for(var e=[],r=this.length;r--;e[r]=t(this[r],r,this));return n(e,this)},E.prototype.filter=function(t){return n(y.filter.call(this,t),this)},E.prototype.find=function(t){return new E(t,this[0],{owner:this})},E.prototype.asArray=function(){return y.slice.call(this)},E.prototype.get=function(t){return this.map(function(n){return n[t]})},E.prototype.set=function(t,n){return this.forEach(r(t)||i(t)?function(e){e[t]=n}:function(n){for(var e in t)n[e]=t[e]})},E.prototype.css=function(t,n){return r(t)&&null==n?this.map(function(n){return getComputedStyle(n)[t]}):this.style.set(t,n)},E.prototype.detach=function(){return this.forEach(function(t){t.parentNode.removeChild(t)})},E.prototype.append=function(t){return this.html(t,function(t,n){t.appendChild(n)})},E.prototype.appendTo=function(t){return new E(t).append(this),this},E.prototype.prepend=function(t){return this.html(t,function(t,n){t.insertBefore(n,t.firstChild)})},E.prototype.prependTo=function(t){return new E(t).prepend(this),this},E.prototype.html=function(t,n){if(null==t)return this.map(function(t){return t.innerHTML});if(!o(n))return this.forEach(function(t){t.innerHTML=""}).append(t);u(t)||(t=[t]);for(var e=[],i=0,f=t.length;i<f;i++)if(u(t[i]))for(var c=0,h=t[i].length;c<h;c++)e.indexOf(t[i][c])<0&&e.push(t[i][c]);else e.push(t[i]);return this.forEach(function(t){return e.forEach(function(e){n(t,r(e)?p(e):e)})})},l.fn=E.prototype,l.wrap=n,l.querySelector=function(t,n){f(t,c(n))};var T=p("<div>");for(var x in T)e(l.fn,x)||function(t){o(T[t])?l.fn[t]=a(t,T):Object.defineProperty(l.fn,t,{get:function(){return this.get(t)},set:function(n){this.set(t,n)}})}(x);return T=null,l});