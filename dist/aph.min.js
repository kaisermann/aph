!function(n,e){typeof exports==='object'&&typeof module!=='undefined'?module.exports=e():typeof define==='function'&&define.amd?define('$$',e):(n.$$=e())}(this,(function(){"use strict";let n=Array.prototype,e=document,t=(n,e)=>typeof n[e]!=='undefined',r=n=>typeof n==='string',o=n=>typeof n==='function';function u(n){let e=[];for(let t=0,r=n.length;t<r;t++)c(n[t])?(e=e.concat(u(n[t]))):(e.indexOf(n[t])<0&&e.push(n[t]));return e}function c(n){return n&&!r(n)&&!o(n)&&t(n,'length')}let i=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/;function l(n,t){let r;if(r=i.exec(n)){if(r[1]){return e.getElementById(r[1])}if(r[2]){return t.getElementsByTagName(r[2])}if(r[3]){return t.getElementsByClassName(r[3])}}return t.querySelectorAll(n)}function p(n){return!n?e:n instanceof Node?n:r(n)?l(n,e)[0]:c(n)?n[0]:e}let f=/^<(\w+)\/?>[^\n\r\S]*(?:$|<\/\1>)/,a;function h(n,t){if(t=f.exec(n)){return e.createElement(t[1])}if(!a){a=e.implementation.createHTMLDocument();let n=a.createElement('base');n.href=document.location.href;a.head.appendChild(n)}a.body.innerHTML=n;return a.body.childNodes[0]}function d(n){while(!n.aph)n=n.owner;return n.aph.proxy}function s(n,e,t){let r=n.map(n=>n[e](...t));return typeof r!=='undefined'&&(typeof r!=='object'||r[0]!=null&&r[r.length-1]!=null)?r:d(n)}function g(n){return new Proxy(n,{set(n,e,t){n.set(e,t)},get(n,e){if(o(n[e])){return n[e].bind(n)}if(t(n,e)){return n[e]}if(o(n[0][e])){return y(e,n[0]).bind(n)}if(t(n[0],e)){return n.get(e)}if(e==='_target'){return n}return void 0}})}let m={};function y(n,e){let r=e.constructor.name;t(m,r)||(m[r]={});if(!t(m[r],n)){let e=n.substr(0,3);m[r][n]=['set','add','remove'].some(t=>e===t&&n.length>t.length)&&n[n.length-1]!=='s'?function(...e){if(e[0].constructor===Object){let[t,...r]=e;return d(this.forEach(e=>{for(let o in t)e[n](o,t[o],...r)}))}return s(this,n,e)}:function(...e){return s(this,n,e)}}return m[r][n]}class E{constructor(n,e,t = {}){this.aph=t;this.aph.context=e=p(e);this.length=0;r(n)&&(n=n[0]==='<'&&n[n.length-1]==='>'?h(n):l(n,e));if(!n)return this;if(n.nodeType===1||n.nodeType===9||n===window)this[0]=n,this.length=1;else{for(let e=this.length=n.length;e--;this[e]=n[e]);}return this.aph.proxy=g(this)}forEach(n){for(let e=0,t=this.length;t--&&n.call(this,this[e],e++)!==!1;);;return d(this)}map(n){let e=[];for(let t=this.length;t--;e[t]=n(this[t],t,this));;return E.wrap(e,this)}filter(e){return E.wrap(n.filter.call(this,e),this)}find(n){return new E(n,this[0],{owner:this})}asArray(){return n.slice.call(this)}get(n){return this.map(e=>e[n])}set(n,e){return d(this.forEach(n.constructor===Object?e=>{for(let t in n)e[t]=n[t]}:t=>{t[n]=e}))}css(n,e){if(r(n)&&e==null){return this.map(e=>getComputedStyle(e)[n])}return this.aph.proxy.style.setProperty(n,e)}detach(){return this.forEach(n=>n.parentNode.removeChild(n))}append(n){return this.html(n,(n,e)=>n.appendChild(e))}appendTo(n){return new E(n).append(this)&&this}prepend(n){return this.html(n,(n,e)=>n.insertBefore(e,n.firstChild))}prependTo(n){return new E(n).prepend(this)&&this}html(n,e){if(n==null){return this.map(n=>n.innerHTML)}if(!o(e)){return this.forEach(n=>{n.innerHTML=''}).append(n)}c(n)||(n=[n]);let t=u(n);return this.forEach(n=>t.forEach(t=>e(n,r(t)?h(t):t)))}static querySelector(n,e){return l(n,p(e))}static wrap(n,e){if(n[0]==null)return;c(n[0])&&n[0][0]&&n[0][0].nodeType===1&&(n=u(n));if(n[0]&&n[0].nodeType===1){return new E(n,e.aph?e.aph.context:null,{owner:e})}n.owner=e;n.map=E.prototype.map;n.filter=E.prototype.filter;n.forEach=E.prototype.forEach;n.get=E.prototype.get;n.set=E.prototype.set;return g(n)}}function w(n,e,t){return new E(n,e,t)}w.fn=E.prototype;w.wrap=E.wrap;w.querySelector=E.querySelector;return w}))