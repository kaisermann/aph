!function(n,e){typeof exports==='object'&&typeof module!=='undefined'?module.exports=e():typeof define==='function'&&define.amd?define('$$',e):(n.$$=e())}(this,(function(){"use strict";let n=Array.prototype,e=document,t=(n,e)=>typeof n[e]!=='undefined',r=n=>typeof n==='string',o=n=>typeof n==='function',u=n=>typeof n==='object'&&typeof n.length==='number';function c(n){let e=[];for(let t=0,r=n.length;t<r;t++)u(n[t])?(e=e.concat(c(n[t]))):(e.indexOf(n[t])<0&&e.push(n[t]));return e}let l=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/;function i(n,t){let r;if(r=l.exec(n)){if(r[1]){return e.getElementById(r[1])}if(r[2]){return t.getElementsByTagName(r[2])}if(r[3]){return t.getElementsByClassName(r[3])}}return t.querySelectorAll(n)}function f(n){return!n?e:n instanceof Node?n:r(n)?i(n,e)[0]:u(n)?n[0]:e}let p=/^<(\w+)\/?>[^\n\r\S]*(?:$|<\/\1>)/,a;function h(n,t){if(t=p.exec(n)){return e.createElement(t[1])}if(!a){a=e.implementation.createHTMLDocument();let n=a.createElement('base');n.href=document.location.href;a.head.appendChild(n)}a.body.innerHTML=n;return a.body.childNodes[0]}function d(n){while(!n.aph)n=n.owner;return n.aph.proxy}function s(n,e,t){let r=n.map(n=>n[e](...t));return typeof r!=='undefined'&&(typeof r!=='object'||r[0]!=null&&r[r.length-1]!=null)?r:d(n)}function m(n){return new Proxy(n,{set(n,e,t){n.set(e,t)},get(n,e){if(o(n[e])){return n[e].bind(n)}if(t(n,e)){return n[e]}if(o(n[0][e])){return E(e,n[0]).bind(n)}if(t(n[0],e)){return n.get(e)}if(e==='_target'){return n}return void 0}})}let g={},y=['set','add','remove'];function E(n,e){let r=e.constructor.name;t(g,r)||(g[r]={});t(g[r],n)||(g[r][n]=y.some(e=>!n.indexOf(e)&&n.length>e.length)&&n[n.length-1]!=='s'?function(...e){if(e[0].constructor===Object){let[t,...r]=e;return d(this.forEach(e=>{for(let o in t)e[n](o,t[o],...r)}))}return s(this,n,e)}:function(...e){return s(this,n,e)});return g[r][n]}class w{constructor(n,e,t = {}){this.aph=t;this.aph.context=e=f(e);this.length=0;r(n)&&(n=n[0]==='<'&&n[n.length-1]==='>'?h(n):i(n,e));if(n){if(n.nodeType===1||n.nodeType===9||n===window)this[0]=n,this.length=1;else{for(let e=this.length=n.length;e--;this[e]=n[e]);}}return this.aph.proxy=m(this)}forEach(n){for(let e=0,t=this.length;t--&&n.call(this,this[e],e++)!==!1;);;return d(this)}map(n){let e=[];for(let t=this.length;t--;e[t]=n(this[t],t,this));;return w.wrap(e,this)}filter(e){return w.wrap(n.filter.call(this,e),this)}find(n){return new w(n,this[0],{owner:this})}asArray(){return n.slice.call(this)}get(n){return this.map(e=>e[n])}set(n,e){return d(this.forEach(n.constructor===Object?e=>{for(let t in n)e[t]=n[t]}:t=>{t[n]=e}))}css(n,e){if(r(n)&&e==null){return this.map(e=>getComputedStyle(e)[n])}this.aph.proxy.style.set(n,e)}detach(){return this.forEach(n=>n.parentNode.removeChild(n))}append(n){return this.html(n,(n,e)=>n.appendChild(e))}appendTo(n){return new w(n).append(this)&&this}prepend(n){return this.html(n,(n,e)=>n.insertBefore(e,n.firstChild))}prependTo(n){return new w(n).prepend(this)&&this}html(n,e){if(n==null){return this.map(n=>n.innerHTML)}if(!o(e)){return this.forEach(n=>{n.innerHTML=''}).append(n)}u(n)||(n=[n]);let t=c(n);return this.forEach(n=>t.forEach(t=>e(n,r(t)?h(t):t)))}static querySelector(n,e){return i(n,f(e))}static wrap(n,e){if(n[0]==null)return;u(n[0])&&n[0][0]&&n[0][0].nodeType===1&&(n=c(n));if(n[0]&&n[0].nodeType===1){return new w(n,e.aph?e.aph.context:null,{owner:e})}n.owner=e;n.map=w.prototype.map;n.filter=w.prototype.filter;n.forEach=w.prototype.forEach;n.get=w.prototype.get;n.set=w.prototype.set;return m(n)}}function b(n,e,t){return new w(n,e,t)}b.fn=w.prototype;b.wrap=w.wrap;b.querySelector=w.querySelector;return b}))