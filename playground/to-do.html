<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
</head>

<body>

	<script type="text/javascript" src="../dist/aph.js"></script>
	<script type="text/javascript" src="../plugins.js"></script>

	<script>
		const input = $$('<input type="text" id="input">')
			.setAttribute('placeholder', 'Type something and press enter')
			.style.setProperty({
				width: '100%',
				height: '50px',
				padding: '15px'
			})
			.set('shouldCreateItem', true)
			.addEventListener('keyup', function(e) {
				if (!this._list) {
					this._list = document.getElementById("list")
				}

				if (e.keyCode === 13) {
					this.value = "";
					this.shouldCreateItem = true
				} else {
					if (this.shouldCreateItem) {
						this._list.$add(this.value);
					}
					this.shouldCreateItem = false
					this._list._items[this._list._items.length - 1] = this.value
				}
				this._list.$refresh()
			})

		const list = $$('<ol id="list">')
			.style.setProperty({
				margin: '15px 0',
				'font-size': '22px',
				'font-weight': '700',
			})
			.set({
				_items: [],
				$add: function(what) {
					this._items.push(what)
					$$(`<li>${what}</li>`).appendTo(this)
				},
				$refresh: function() {
					this._items.forEach((text, i) => {
						if (this.childNodes[i].textContent !== text) {
							this.childNodes[i].textContent = text
						}
					})
				}
			})

		$$('body').html(
			$$('<div class="container">').html([
				'<h1>Simple To-Do</h1>',
				input,
				list
			])
		)

		$$(document)
			.addEventListener('DOMContentLoaded', function(e) {
				input.focus()
			})
	</script>
</body>

</html>
